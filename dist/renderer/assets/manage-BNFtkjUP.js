import{r,j as e,c as U}from"./client-C9yhCDaK.js";const{ipcRenderer:W}=window.require("electron"),I=({onTaskAdded:n})=>{const[h,f]=r.useState(""),[p,t]=r.useState(""),[d,u]=r.useState(""),[g,c]=r.useState(""),[x,a]=r.useState("none"),m=async l=>{if(l.preventDefault(),!h||!p||!d)return;const k=await W.invoke("tasks:add",{title:h,start:p,end:d,description:g,repeat:x});f(""),t(""),u(""),c(""),a("none"),n&&n(k)};return e.jsxs("form",{className:"task-form",onSubmit:m,style:{marginBottom:16},children:[e.jsx("input",{type:"text",placeholder:"Title",value:h,onChange:l=>f(l.target.value),required:!0}),e.jsx("input",{type:"datetime-local",placeholder:"Start",value:p,onChange:l=>t(l.target.value),required:!0}),e.jsx("input",{type:"datetime-local",placeholder:"End",value:d,onChange:l=>u(l.target.value),required:!0}),e.jsx("input",{type:"text",placeholder:"Description (optional)",value:g,onChange:l=>c(l.target.value)}),e.jsxs("select",{value:x,onChange:l=>a(l.target.value),style:{marginBottom:8},children:[e.jsx("option",{value:"none",children:"Does not repeat"}),e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"})]}),e.jsx("button",{type:"submit",children:"Add Task"})]})},{ipcRenderer:w}=window.require("electron"),E=({fetchTasksRef:n})=>{const[h,f]=r.useState([]),p=r.useCallback(()=>{w.invoke("tasks:get").then(t=>{f(t)})},[]);return r.useEffect(()=>{w.invoke("ping").then(t=>{console.log("Ping result:",t)}),p(),n&&(n.current=p)},[p,n]),e.jsx("div",{className:"task-list",children:h.length===0?e.jsx("div",{children:"No tasks found."}):e.jsx("ul",{children:h.map(t=>{const d=new Date(t.start),u=new Date(t.end),g=`${d.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})} - ${u.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}`,c=`${d.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit",hour12:!0})} - ${u.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit",hour12:!0})}`;return e.jsxs("li",{children:[e.jsx("strong",{children:t.title})," (",g,e.jsx("span",{style:{color:"#bbb",margin:"0 8px"},children:"•"}),e.jsx("span",{style:{color:"#888",fontSize:"0.97em"},children:c}),")",t.completed&&" ✅",t.repeat&&t.repeat!=="none"&&e.jsxs("span",{style:{marginLeft:8,color:"#888",fontSize:"0.9em"},children:["[Repeats: ",t.repeat.charAt(0).toUpperCase()+t.repeat.slice(1),"]"]})]},t.id)})})})};console.log("Manage.tsx loaded!");const L=[{key:"tasks",label:"Tasks"},{key:"hud",label:"HUD Options"},{key:"updates",label:"Updates"},{key:"archive",label:"Archive"},{key:"about",label:"About"}],y={darkMode:!1,showCurrentTime:!1,clickThrough:!0,opacity:.85,placement:"top-center",alwaysOnTop:!0},H=()=>{try{const n=localStorage.getItem("hudSettings");if(n)return{...y,...JSON.parse(n)}}catch{}return{...y}},q=n=>{if(localStorage.setItem("hudSettings",JSON.stringify(n)),window.require){const{ipcRenderer:h}=window.require("electron");console.log("[Renderer] Sending hud-settings-update:",n),h.send("hud-settings-update",n)}},N=()=>{const[n,h]=r.useState("tasks"),f=r.useRef(()=>{}),p=r.useCallback(()=>{f.current&&f.current()},[]),[t,d]=r.useState(H()),[u,g]=r.useState(""),[c,x]=r.useState("idle"),[a,m]=r.useState(null),[l,k]=r.useState(!0),[j,v]=r.useState(!1),s=window.require?window.require("electron").ipcRenderer:null,[S,M]=r.useState([]),b=r.useCallback(()=>{s&&s.invoke("get-archived-tasks").then(M)},[s]);r.useEffect(()=>{n==="archive"&&b()},[n,b]);const C=o=>{s&&s.invoke("restore-archived-task",o).then(b)},R=o=>{s&&s.invoke("delete-archived-task",o).then(b)};r.useEffect(()=>{q(t)},[t]),r.useEffect(()=>{const o=t.darkMode?"#23272f":"#f6f7fb";document.body.style.background=o;const i=document.getElementById("root");i&&(i.style.background=o)},[t.darkMode]),r.useEffect(()=>{if(n==="hud"&&(console.log("Rendering HUD Options section"),window.require)){const{ipcRenderer:o}=window.require("electron");o.send("test-event",{foo:123}),console.log("[Renderer] Sent test-event")}},[n]),r.useEffect(()=>(s&&(s.invoke("get-app-version").then(g),s.invoke("get-update-status").then(o=>{x(o.status),m(o.info),k(o.autoUpdate)}),s.on("update-status",(o,{status:i,info:A})=>{x(i),m(A),v(!1)})),()=>{s&&s.removeAllListeners("update-status")}),[]);const z=()=>{s&&(v(!0),s.invoke("check-for-updates"))},D=o=>{const i=o.target.checked;k(i),s&&s.invoke("set-auto-update",i)},B=()=>{d({...y})};return e.jsxs("div",{style:{display:"flex",height:"100vh",width:"100vw",background:t.darkMode?"#23272f":"#f6f7fb",fontFamily:"Inter, Arial, sans-serif",color:t.darkMode?"#f3f3f3":"#222",transition:"background 0.2s, color 0.2s",margin:0,padding:0,boxSizing:"border-box"},children:[e.jsx("nav",{style:{width:160,height:"100vh",background:t.darkMode?"#181b20":"#fff",borderRight:t.darkMode?"1px solid #2c2f36":"1px solid #eee",display:"flex",flexDirection:"column",alignItems:"stretch",padding:0,boxShadow:t.darkMode?"2px 0 8px rgba(0,0,0,0.12)":"2px 0 8px rgba(0,0,0,0.03)",transition:"background 0.2s, border 0.2s"},children:e.jsx("div",{style:{padding:"24px 0",flex:1,display:"flex",flexDirection:"column"},children:L.map(o=>e.jsx("button",{onClick:()=>h(o.key),style:{background:n===o.key?t.darkMode?"#23272f":"#e3e8f0":"none",border:"none",borderLeft:n===o.key?"4px solid #4fa3e3":"4px solid transparent",color:t.darkMode?n===o.key?"#fff":"#b3b3b3":"#222",fontWeight:n===o.key?700:400,fontSize:16,padding:"12px 20px",textAlign:"left",cursor:"pointer",outline:"none",transition:"background 0.2s, border 0.2s, color 0.2s"},children:o.label},o.key))})}),e.jsxs("main",{style:{flex:1,padding:"32px 40px",background:t.darkMode?"#23272f":"#f6f7fb",display:"flex",flexDirection:"column",minWidth:0,color:t.darkMode?"#f3f3f3":"#222",transition:"background 0.2s, color 0.2s",minHeight:"100vh",boxSizing:"border-box"},children:[n==="tasks"&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{style:{fontWeight:700,fontSize:24,marginBottom:16,color:t.darkMode?"#f3f3f3":"#222"},children:"Tasks"}),e.jsx(I,{onTaskAdded:p}),e.jsx(E,{fetchTasksRef:f})]}),n==="hud"&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{style:{fontWeight:700,fontSize:24,marginBottom:16,color:t.darkMode?"#f3f3f3":"#222"},children:"HUD Options"}),e.jsxs("div",{style:{color:t.darkMode?"#f3f3f3":"#222",fontSize:16,marginTop:24,maxWidth:400},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",marginBottom:18,gap:10},children:[e.jsx("input",{type:"checkbox",checked:t.darkMode,onChange:o=>d(i=>({...i,darkMode:o.target.checked}))}),"Dark mode"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",marginBottom:18,gap:10},children:[e.jsx("input",{type:"checkbox",checked:t.showCurrentTime,onChange:o=>d(i=>({...i,showCurrentTime:o.target.checked}))}),"Show current time"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",marginBottom:18,gap:10},children:[e.jsx("input",{type:"checkbox",checked:t.clickThrough,onChange:o=>d(i=>({...i,clickThrough:o.target.checked}))}),"Enable click-through"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",marginBottom:18,gap:10},children:[e.jsx("input",{type:"checkbox",checked:t.alwaysOnTop,onChange:o=>d(i=>({...i,alwaysOnTop:o.target.checked}))}),"Always on Top"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",marginBottom:18,gap:10},children:["Placement",e.jsxs("select",{value:t.placement,onChange:o=>{console.log("[Renderer] Placement changed to:",o.target.value),d(i=>({...i,placement:o.target.value}))},style:{marginLeft:12},children:[e.jsx("option",{value:"top-left",children:"Top Left"}),e.jsx("option",{value:"top-center",children:"Top Center"}),e.jsx("option",{value:"top-right",children:"Top Right"}),e.jsx("option",{value:"bottom-left",children:"Bottom Left"}),e.jsx("option",{value:"bottom-center",children:"Bottom Center"}),e.jsx("option",{value:"bottom-right",children:"Bottom Right"}),e.jsx("option",{value:"center",children:"Center"})]})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",marginBottom:18,gap:10},children:["Opacity",e.jsx("input",{type:"range",min:.5,max:1,step:.01,value:t.opacity,onChange:o=>d(i=>({...i,opacity:Number(o.target.value)})),style:{flex:1,marginLeft:12}}),e.jsxs("span",{style:{width:40,textAlign:"right",color:t.darkMode?"#b3b3b3":"#888",fontSize:15},children:[Math.round(t.opacity*100),"%"]})]}),e.jsx("button",{onClick:B,style:{marginTop:12,background:t.darkMode?"#23272f":"#f3f3f3",border:t.darkMode?"1px solid #444":"1px solid #ddd",borderRadius:6,padding:"8px 18px",fontSize:15,color:t.darkMode?"#f3f3f3":"#444",cursor:"pointer",fontWeight:500,transition:"background 0.2s, border 0.2s"},children:"Reset to Defaults"})]}),e.jsxs("div",{style:{marginTop:40,background:t.darkMode?"rgba(30,34,40,0.95)":`rgba(0,0,0,${t.opacity})`,borderRadius:10,boxShadow:"0 2px 12px rgba(0,0,0,0.08)",padding:24,color:t.darkMode?"#f3f3f3":"#fff",minHeight:80,maxWidth:340,fontSize:18,fontWeight:500,letterSpacing:.2,display:"flex",flexDirection:"column",alignItems:"center",border:t.darkMode?"1.5px solid #222":"1.5px solid #2222",transition:"background 0.2s, color 0.2s"},children:[e.jsx("span",{style:{fontWeight:700,fontSize:20,marginBottom:6,color:t.darkMode?"#b3d1f7":"#cce6ff"},children:"HUD Preview"}),e.jsxs("span",{style:{fontSize:16,color:t.darkMode?"#b3d1f7":"#cce6ff"},children:["Current Task: ",e.jsx("b",{style:{color:(t.darkMode,"#fff")},children:"Example Task"})]}),t.showCurrentTime&&e.jsx("span",{style:{fontSize:15,color:t.darkMode?"#eee":"#e0e0e0",marginTop:4},children:"12:34:56 PM"}),e.jsx("span",{style:{fontSize:15,color:t.darkMode?"#eee":"#e0e0e0",marginTop:4},children:"(00:12:34 left)"})]})]}),n==="updates"&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{style:{fontWeight:700,fontSize:24,marginBottom:16,color:t.darkMode?"#f3f3f3":"#222"},children:"Updates"}),e.jsxs("div",{style:{color:t.darkMode?"#f3f3f3":"#222",fontSize:16,marginTop:24,maxWidth:500},children:[e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("b",{children:"Current Version:"})," ",u]}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("b",{children:"Update Status:"})," ",j?"Checking...":c.charAt(0).toUpperCase()+c.slice(1)]}),c==="available"&&a&&e.jsxs("div",{style:{marginBottom:12,color:"#4fa3e3"},children:[e.jsx("b",{children:"New version available:"})," ",a.version||""]}),c==="downloading"&&a&&e.jsxs("div",{style:{marginBottom:12,color:"#4fa3e3"},children:[e.jsx("b",{children:"Downloading update..."})," ",a.percent?`${Math.round(a.percent)}%`:""]}),c==="downloaded"&&a&&e.jsxs("div",{style:{marginBottom:12,color:"#4fa3e3"},children:[e.jsx("b",{children:"Update downloaded!"})," Restart the app to apply the update."]}),c==="error"&&a&&e.jsxs("div",{style:{marginBottom:12,color:"red"},children:[e.jsx("b",{children:"Update error:"})," ",a.message||String(a)]}),a&&a.releaseNotes&&e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("b",{children:"Release Notes:"}),e.jsx("div",{style:{background:"#2222",padding:10,borderRadius:6,marginTop:4,maxHeight:120,overflowY:"auto",fontSize:15},dangerouslySetInnerHTML:{__html:a.releaseNotes}})]}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("button",{onClick:z,disabled:j,style:{background:"#4fa3e3",color:"#fff",border:"none",borderRadius:6,padding:"8px 18px",fontSize:15,cursor:"pointer",fontWeight:500,marginRight:16},children:"Check for Updates"}),e.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:8,fontSize:15},children:[e.jsx("input",{type:"checkbox",checked:l,onChange:D}),"Enable Auto-Update"]})]})]})]}),n==="archive"&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{style:{fontWeight:700,fontSize:24,marginBottom:16,color:t.darkMode?"#f3f3f3":"#222"},children:"Archive"}),e.jsxs("div",{style:{color:t.darkMode?"#f3f3f3":"#222",fontSize:16,marginTop:24,maxWidth:600},children:[S.length===0&&e.jsx("div",{children:"No archived tasks."}),S.map(o=>e.jsxs("div",{style:{background:t.darkMode?"#23272f":"#f6f7fb",border:"1px solid #ccc",borderRadius:8,padding:16,marginBottom:14,display:"flex",flexDirection:"column",gap:6},children:[e.jsx("div",{children:e.jsx("b",{children:o.title})}),e.jsxs("div",{style:{fontSize:14,color:"#888"},children:["Ended: ",new Date(o.end).toLocaleString()]}),o.expiredAt&&e.jsxs("div",{style:{fontSize:13,color:"#aaa"},children:["Archived: ",new Date(o.expiredAt+24*60*60*1e3).toLocaleString()]}),e.jsxs("div",{style:{display:"flex",gap:10,marginTop:6},children:[e.jsx("button",{onClick:()=>C(o.id),style:{background:"#4fa3e3",color:"#fff",border:"none",borderRadius:6,padding:"6px 14px",fontSize:14,cursor:"pointer",fontWeight:500},children:"Restore"}),e.jsx("button",{onClick:()=>R(o.id),style:{background:"#e34f4f",color:"#fff",border:"none",borderRadius:6,padding:"6px 14px",fontSize:14,cursor:"pointer",fontWeight:500},children:"Delete"})]})]},o.id))]})]}),n==="about"&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{style:{fontWeight:700,fontSize:24,marginBottom:16,color:t.darkMode?"#f3f3f3":"#222"},children:"About"}),e.jsxs("div",{style:{color:t.darkMode?"#b3b3b3":"#666",fontSize:16,marginTop:24},children:[e.jsx("p",{children:"Time Keeper v1.0"}),e.jsx("p",{children:"Modern minimalist time/task HUD for desktop."}),e.jsxs("p",{style:{fontSize:14,color:t.darkMode?"#888":"#aaa",marginTop:16},children:["© ",new Date().getFullYear()," Time Keeper"]})]})]})]})]})},T=document.getElementById("root");T&&U(T).render(e.jsx(N,{}));
