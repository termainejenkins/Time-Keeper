import{r,j as e,c as R}from"./client-C9yhCDaK.js";const{ipcRenderer:B}=window.require("electron"),D=({onTaskAdded:n})=>{const[c,h]=r.useState(""),[u,t]=r.useState(""),[a,g]=r.useState(""),[f,d]=r.useState(""),[x,i]=r.useState("none"),m=async l=>{if(l.preventDefault(),!c||!u||!a)return;const k=await B.invoke("tasks:add",{title:c,start:u,end:a,description:f,repeat:x});h(""),t(""),g(""),d(""),i("none"),n&&n(k)};return e.jsxs("form",{className:"task-form",onSubmit:m,style:{marginBottom:16},children:[e.jsx("input",{type:"text",placeholder:"Title",value:c,onChange:l=>h(l.target.value),required:!0}),e.jsx("input",{type:"datetime-local",placeholder:"Start",value:u,onChange:l=>t(l.target.value),required:!0}),e.jsx("input",{type:"datetime-local",placeholder:"End",value:a,onChange:l=>g(l.target.value),required:!0}),e.jsx("input",{type:"text",placeholder:"Description (optional)",value:f,onChange:l=>d(l.target.value)}),e.jsxs("select",{value:x,onChange:l=>i(l.target.value),style:{marginBottom:8},children:[e.jsx("option",{value:"none",children:"Does not repeat"}),e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"})]}),e.jsx("button",{type:"submit",children:"Add Task"})]})},{ipcRenderer:v}=window.require("electron"),z=({fetchTasksRef:n})=>{const[c,h]=r.useState([]),u=r.useCallback(()=>{v.invoke("tasks:get").then(t=>{h(t)})},[]);return r.useEffect(()=>{v.invoke("ping").then(t=>{console.log("Ping result:",t)}),u(),n&&(n.current=u)},[u,n]),e.jsx("div",{className:"task-list",children:c.length===0?e.jsx("div",{children:"No tasks found."}):e.jsx("ul",{children:c.map(t=>{const a=new Date(t.start),g=new Date(t.end),f=`${a.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})} - ${g.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}`,d=`${a.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit",hour12:!0})} - ${g.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit",hour12:!0})}`;return e.jsxs("li",{children:[e.jsx("strong",{children:t.title})," (",f,e.jsx("span",{style:{color:"#bbb",margin:"0 8px"},children:"•"}),e.jsx("span",{style:{color:"#888",fontSize:"0.97em"},children:d}),")",t.completed&&" ✅",t.repeat&&t.repeat!=="none"&&e.jsxs("span",{style:{marginLeft:8,color:"#888",fontSize:"0.9em"},children:["[Repeats: ",t.repeat.charAt(0).toUpperCase()+t.repeat.slice(1),"]"]})]},t.id)})})})};console.log("Manage.tsx loaded!");const U=[{key:"tasks",label:"Tasks"},{key:"hud",label:"HUD Options"},{key:"updates",label:"Updates"},{key:"about",label:"About"}],b={darkMode:!1,showCurrentTime:!1,clickThrough:!0,opacity:.85,placement:"top-center",alwaysOnTop:!0},I=()=>{try{const n=localStorage.getItem("hudSettings");if(n)return{...b,...JSON.parse(n)}}catch{}return{...b}},A=n=>{if(localStorage.setItem("hudSettings",JSON.stringify(n)),window.require){const{ipcRenderer:c}=window.require("electron");console.log("[Renderer] Sending hud-settings-update:",n),c.send("hud-settings-update",n)}},E=()=>{const[n,c]=r.useState("tasks"),h=r.useRef(()=>{}),u=r.useCallback(()=>{h.current&&h.current()},[]),[t,a]=r.useState(I()),[g,f]=r.useState(""),[d,x]=r.useState("idle"),[i,m]=r.useState(null),[l,k]=r.useState(!0),[y,j]=r.useState(!1),p=window.require?window.require("electron").ipcRenderer:null;r.useEffect(()=>{A(t)},[t]),r.useEffect(()=>{const o=t.darkMode?"#23272f":"#f6f7fb";document.body.style.background=o;const s=document.getElementById("root");s&&(s.style.background=o)},[t.darkMode]),r.useEffect(()=>{if(n==="hud"&&(console.log("Rendering HUD Options section"),window.require)){const{ipcRenderer:o}=window.require("electron");o.send("test-event",{foo:123}),console.log("[Renderer] Sent test-event")}},[n]),r.useEffect(()=>(p&&(p.invoke("get-app-version").then(f),p.invoke("get-update-status").then(o=>{x(o.status),m(o.info),k(o.autoUpdate)}),p.on("update-status",(o,{status:s,info:C})=>{x(s),m(C),j(!1)})),()=>{p&&p.removeAllListeners("update-status")}),[]);const w=()=>{p&&(j(!0),p.invoke("check-for-updates"))},M=o=>{const s=o.target.checked;k(s),p&&p.invoke("set-auto-update",s)},T=()=>{a({...b})};return e.jsxs("div",{style:{display:"flex",height:"100vh",width:"100vw",background:t.darkMode?"#23272f":"#f6f7fb",fontFamily:"Inter, Arial, sans-serif",color:t.darkMode?"#f3f3f3":"#222",transition:"background 0.2s, color 0.2s",margin:0,padding:0,boxSizing:"border-box"},children:[e.jsx("nav",{style:{width:160,height:"100vh",background:t.darkMode?"#181b20":"#fff",borderRight:t.darkMode?"1px solid #2c2f36":"1px solid #eee",display:"flex",flexDirection:"column",alignItems:"stretch",padding:0,boxShadow:t.darkMode?"2px 0 8px rgba(0,0,0,0.12)":"2px 0 8px rgba(0,0,0,0.03)",transition:"background 0.2s, border 0.2s"},children:e.jsx("div",{style:{padding:"24px 0",flex:1,display:"flex",flexDirection:"column"},children:U.map(o=>e.jsx("button",{onClick:()=>c(o.key),style:{background:n===o.key?t.darkMode?"#23272f":"#e3e8f0":"none",border:"none",borderLeft:n===o.key?"4px solid #4fa3e3":"4px solid transparent",color:t.darkMode?n===o.key?"#fff":"#b3b3b3":"#222",fontWeight:n===o.key?700:400,fontSize:16,padding:"12px 20px",textAlign:"left",cursor:"pointer",outline:"none",transition:"background 0.2s, border 0.2s, color 0.2s"},children:o.label},o.key))})}),e.jsxs("main",{style:{flex:1,padding:"32px 40px",background:t.darkMode?"#23272f":"#f6f7fb",display:"flex",flexDirection:"column",minWidth:0,color:t.darkMode?"#f3f3f3":"#222",transition:"background 0.2s, color 0.2s",minHeight:"100vh",boxSizing:"border-box"},children:[n==="tasks"&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{style:{fontWeight:700,fontSize:24,marginBottom:16,color:t.darkMode?"#f3f3f3":"#222"},children:"Tasks"}),e.jsx(D,{onTaskAdded:u}),e.jsx(z,{fetchTasksRef:h})]}),n==="hud"&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{style:{fontWeight:700,fontSize:24,marginBottom:16,color:t.darkMode?"#f3f3f3":"#222"},children:"HUD Options"}),e.jsxs("div",{style:{color:t.darkMode?"#f3f3f3":"#222",fontSize:16,marginTop:24,maxWidth:400},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",marginBottom:18,gap:10},children:[e.jsx("input",{type:"checkbox",checked:t.darkMode,onChange:o=>a(s=>({...s,darkMode:o.target.checked}))}),"Dark mode"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",marginBottom:18,gap:10},children:[e.jsx("input",{type:"checkbox",checked:t.showCurrentTime,onChange:o=>a(s=>({...s,showCurrentTime:o.target.checked}))}),"Show current time"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",marginBottom:18,gap:10},children:[e.jsx("input",{type:"checkbox",checked:t.clickThrough,onChange:o=>a(s=>({...s,clickThrough:o.target.checked}))}),"Enable click-through"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",marginBottom:18,gap:10},children:[e.jsx("input",{type:"checkbox",checked:t.alwaysOnTop,onChange:o=>a(s=>({...s,alwaysOnTop:o.target.checked}))}),"Always on Top"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",marginBottom:18,gap:10},children:["Placement",e.jsxs("select",{value:t.placement,onChange:o=>{console.log("[Renderer] Placement changed to:",o.target.value),a(s=>({...s,placement:o.target.value}))},style:{marginLeft:12},children:[e.jsx("option",{value:"top-left",children:"Top Left"}),e.jsx("option",{value:"top-center",children:"Top Center"}),e.jsx("option",{value:"top-right",children:"Top Right"}),e.jsx("option",{value:"bottom-left",children:"Bottom Left"}),e.jsx("option",{value:"bottom-center",children:"Bottom Center"}),e.jsx("option",{value:"bottom-right",children:"Bottom Right"}),e.jsx("option",{value:"center",children:"Center"})]})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",marginBottom:18,gap:10},children:["Opacity",e.jsx("input",{type:"range",min:.5,max:1,step:.01,value:t.opacity,onChange:o=>a(s=>({...s,opacity:Number(o.target.value)})),style:{flex:1,marginLeft:12}}),e.jsxs("span",{style:{width:40,textAlign:"right",color:t.darkMode?"#b3b3b3":"#888",fontSize:15},children:[Math.round(t.opacity*100),"%"]})]}),e.jsx("button",{onClick:T,style:{marginTop:12,background:t.darkMode?"#23272f":"#f3f3f3",border:t.darkMode?"1px solid #444":"1px solid #ddd",borderRadius:6,padding:"8px 18px",fontSize:15,color:t.darkMode?"#f3f3f3":"#444",cursor:"pointer",fontWeight:500,transition:"background 0.2s, border 0.2s"},children:"Reset to Defaults"})]}),e.jsxs("div",{style:{marginTop:40,background:t.darkMode?"rgba(30,34,40,0.95)":`rgba(0,0,0,${t.opacity})`,borderRadius:10,boxShadow:"0 2px 12px rgba(0,0,0,0.08)",padding:24,color:t.darkMode?"#f3f3f3":"#fff",minHeight:80,maxWidth:340,fontSize:18,fontWeight:500,letterSpacing:.2,display:"flex",flexDirection:"column",alignItems:"center",border:t.darkMode?"1.5px solid #222":"1.5px solid #2222",transition:"background 0.2s, color 0.2s"},children:[e.jsx("span",{style:{fontWeight:700,fontSize:20,marginBottom:6,color:t.darkMode?"#b3d1f7":"#cce6ff"},children:"HUD Preview"}),e.jsxs("span",{style:{fontSize:16,color:t.darkMode?"#b3d1f7":"#cce6ff"},children:["Current Task: ",e.jsx("b",{style:{color:(t.darkMode,"#fff")},children:"Example Task"})]}),t.showCurrentTime&&e.jsx("span",{style:{fontSize:15,color:t.darkMode?"#eee":"#e0e0e0",marginTop:4},children:"12:34:56 PM"}),e.jsx("span",{style:{fontSize:15,color:t.darkMode?"#eee":"#e0e0e0",marginTop:4},children:"(00:12:34 left)"})]})]}),n==="updates"&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{style:{fontWeight:700,fontSize:24,marginBottom:16,color:t.darkMode?"#f3f3f3":"#222"},children:"Updates"}),e.jsxs("div",{style:{color:t.darkMode?"#f3f3f3":"#222",fontSize:16,marginTop:24,maxWidth:500},children:[e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("b",{children:"Current Version:"})," ",g]}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("b",{children:"Update Status:"})," ",y?"Checking...":d.charAt(0).toUpperCase()+d.slice(1)]}),d==="available"&&i&&e.jsxs("div",{style:{marginBottom:12,color:"#4fa3e3"},children:[e.jsx("b",{children:"New version available:"})," ",i.version||""]}),d==="downloading"&&i&&e.jsxs("div",{style:{marginBottom:12,color:"#4fa3e3"},children:[e.jsx("b",{children:"Downloading update..."})," ",i.percent?`${Math.round(i.percent)}%`:""]}),d==="downloaded"&&i&&e.jsxs("div",{style:{marginBottom:12,color:"#4fa3e3"},children:[e.jsx("b",{children:"Update downloaded!"})," Restart the app to apply the update."]}),d==="error"&&i&&e.jsxs("div",{style:{marginBottom:12,color:"red"},children:[e.jsx("b",{children:"Update error:"})," ",i.message||String(i)]}),i&&i.releaseNotes&&e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("b",{children:"Release Notes:"}),e.jsx("div",{style:{background:"#2222",padding:10,borderRadius:6,marginTop:4,maxHeight:120,overflowY:"auto",fontSize:15},dangerouslySetInnerHTML:{__html:i.releaseNotes}})]}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("button",{onClick:w,disabled:y,style:{background:"#4fa3e3",color:"#fff",border:"none",borderRadius:6,padding:"8px 18px",fontSize:15,cursor:"pointer",fontWeight:500,marginRight:16},children:"Check for Updates"}),e.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:8,fontSize:15},children:[e.jsx("input",{type:"checkbox",checked:l,onChange:M}),"Enable Auto-Update"]})]})]})]}),n==="about"&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{style:{fontWeight:700,fontSize:24,marginBottom:16,color:t.darkMode?"#f3f3f3":"#222"},children:"About"}),e.jsxs("div",{style:{color:t.darkMode?"#b3b3b3":"#666",fontSize:16,marginTop:24},children:[e.jsx("p",{children:"Time Keeper v1.0"}),e.jsx("p",{children:"Modern minimalist time/task HUD for desktop."}),e.jsxs("p",{style:{fontSize:14,color:t.darkMode?"#888":"#aaa",marginTop:16},children:["© ",new Date().getFullYear()," Time Keeper"]})]})]})]})]})},S=document.getElementById("root");S&&R(S).render(e.jsx(E,{}));
